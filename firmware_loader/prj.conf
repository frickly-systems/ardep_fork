# Disable the main application's USB stack (firmware loader has its own USB DFU)
CONFIG_ARDEP_USB=n

# Console and UART configuration
CONFIG_CONSOLE=y
CONFIG_SERIAL=y
CONFIG_UART_CONSOLE=y

# Logging configuration
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_APP_LOG_LEVEL_INF=y
CONFIG_LOG_MODE_DEFERRED=y

# UDS
CONFIG_CAN=y
CONFIG_UDS=y
CONFIG_STD_C11=y
CONFIG_UDS_LOG_LEVEL_DBG=y

CONFIG_UDS_UPLOAD_DOWNLOAD_MODULE=y
# Disabled to prevent re-switching to firmware loader
CONFIG_UDS_DEFAULT_INSTANCE_DISABLE_SWITCH_TO_FIRMWARE_LOADER=y

CONFIG_ISO14229_THREAD_STACK_SIZE=2048
CONFIG_ISO14229_THREAD_SLEEP_US=1500

# Flash configuration (required for firmware download)
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_STREAM_FLASH=y
CONFIG_IMG_MANAGER=y
CONFIG_IMG_ERASE_PROGRESSIVELY=y
CONFIG_REBOOT=y

# MPU configuration to protect code execution during flash write
CONFIG_ARM_MPU=y

CONFIG_USBD_DFU_FLASH_SLOT1=n
CONFIG_MCUBOOT_IMG_MANAGER=y
